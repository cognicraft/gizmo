<gizmo-explorer>
    <div class="explorer">
        <form class="location" onsubmit={submit}>
            <input class="url" value={url} onchange={onchange}></input>
            <button class="go" type="submit">Go</button>
        </form>
        <div class="authenticator">
            <gizmo-authenticator />
        </div>
        <div class="content">
            <gizmo-item if={data} data={data} expanded={true} root={true} />
        </div>
    </div>
    <style scoped>
        .location{
            width: 100%;
            height: 3em;
            position: fixed;
            left: 0;
            top: 0;
            background: #bbbbbb;
            padding: .5em;
            border-bottom: 1px solid #666666;
            border-top: 1px solid #666666;
        }
        .location>.url{
            width: calc(100% - 85px);
        }
        .location>.go{
            width: 80px;
        }
        .explorer>.authenticator {
            position: fixed;
            right: 0;
            top: 3em;
            background: #bbbbbb;
            padding: .5em;
            border-left: 1px solid #666666;
            border-bottom: 1px solid #666666;
        }
        .explorer>.content {
            padding-top: 4em;
        }
    </style>
    <script>
        let tag = this;
        this.url = this.opts.url;
        this.data = null;
        
        this.transform = function(url){
            if (!url){
                return url;
            }
            let t = url;
            if (url.startsWith('http://')){
                t = '#/n/'+ url.substr(7);
            } else if (url.startsWith('https://')) {
                t = '#/s/'+ url.substr(8);
            }
            return t;
        }; 
        
        this.onchange = function(e) {
            var value = e.target.value;
            tag.update({url: value});
        };

        this.submit = function(e){
            e.preventDefault();
            load();
        };

        let load = function(){
            Gizmo.GET(tag.url).then(function(response) {
              return response.json();
            }).then(function(item) {
              tag.update({data: item});
            });
        };

        load();
    </script>
</gizmo-explorer>